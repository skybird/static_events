<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1, maximum-scale=1" />
    <title></title>
    <link href="main.css" rel="stylesheet" type="text/css">
    <!-- <link href="animate.min.css" rel="stylesheet" type="text/css"> -->
</head>

<body>
    <script>
    var ua = navigator.userAgent.toLowerCase();
    if (ua.indexOf('android') != -1 || ua.indexOf("micromessenger") != -1 || ua.indexOf('iphone') != -1) {} else {
        window.location.href = '2014_pc.html'
    }
    </script>
    <img id="share-icon" src="img/share-icon.png" alt="" />
    <div class="first-page">
        <div class="logo"></div>
        <!-- <div class="first-lee">
        
        </div> -->
        <img class='lee-bg' src="img/first-screen/1p_bg.png">
        <img class='lee' src="img/first-screen/lee.png">
        <img class='lee-title1' src="img/first-screen/lee-title1.png">
        <img class='lee-title2' src="img/first-screen/lee-title2.png">
        <div style="text-align: center" id="div-start" class="hidden">
            <div id="start-btn"></div>
        </div>
        <img class='crash' src="img/crash.png">
    </div>
    <div class="pages-cover hidden">
        <div class="wscn-pages">
        </div>
    </div>
    <div class="result-page hidden">
        <div class="replay"></div>
        <div id='share2friends' class="share2friends  swing">
        </div>
        <img class='result-img'>
        <div class="result-content"></div>
        <a class='download-btn' href="">
            <img src="img/result/download.png">
        </a>
    </div>
    <script src="fastclick.js"></script>
    <script src="jquery-2.1.3.min.js"></script>
    <script src="model.js"></script>
    <audio id="music" src="audio/bgm.mp3"></audio>
</body>
<script>
(function(doc, win) {
    var docEl = doc.documentElement,
        resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
        recalc = function() {
            var clientWidth = docEl.clientWidth;
            if (!clientWidth) return;
            docEl.style.fontSize = 100 * (clientWidth / 320) + 'px';
        };

    // Abort if browser does not support addEventListener
    if (!doc.addEventListener) return;
    win.addEventListener(resizeEvt, recalc, false);
    doc.addEventListener('DOMContentLoaded', recalc, false);
})(document, window);

$(function() {
    FastClick.attach(document.body);
});


var music = document.getElementById("music");
var imgSrc = $('.lee-bg').attr('src');
var tamp = Date.parse(new Date());

$('.lee-bg').attr('src', imgSrc + '?' + tamp)
$('.lee-bg').load(function() {
    music.play();
});

var touch_start = 'click';

var transform = 'webkitTransform';

if (typeof document.body.style.transform === 'string') {
    transform = 'transform';

};

function firstScreen() {
    $('#div-start').removeClass('hidden').addClass('animated fadeIn');
    setTimeout(function() {
        $('.lee').addClass('bounceIn');
    }, 500)
    setTimeout(function() {
        $('.lee-title1').addClass('zoomInRight');
    }, 1500)
    setTimeout(function() {
        $('.lee-title2').addClass('zoomInRight');
    }, 2600)
    setTimeout(function() {
        $('.crash').addClass('active');
    }, 5400)
    setTimeout(function() {
        $('#start-btn').addClass('rubberBand');
    }, 4000)
    setTimeout(function() {
        $('#start-btn').addClass('active');
    }, 4000)
}

$('#start-btn').on(touch_start, function() {
    $('.first-page').addClass('hidden');
    $('.pages-cover').removeClass('hidden');
})

firstScreen();

var pageNum = models.length;
var pagesDom = $('.wscn-pages').css({
    width: pageNum * 100 + '%'
});
var pageWidth = 100 / pageNum;
var imgIndex = 1;
for (var i = 0; i < models.length; i++) {
    var model = models[i];
    var html = '<div class="wscn-page" style="width:' + pageWidth + '%; ' + '"data-page-index="' + i + '">' +
        '<img class="question-img fadeIn" src="img/question/q' + imgIndex + '.png">' +
        '<div class="choices">' +
        '<div class="question-content">' + model.question + '</div>' +
        '<div class="btn-choice btn-choice-1" data-q-index="1">A ' + model.answer1.qtext + '</div>' +
        '<div class="btn-choice btn-choice-2" data-q-index="2">B ' + model.answer2.qtext + '</div>' +
        '<div class="btn-choice btn-choice-3" data-q-index="3">C ' + model.answer3.qtext + '</div>' +
        '</div>'
    pagesDom.append(html);
    imgIndex++;
}

var curIndex = 0;
var profit = 0;

function moveNext() {

    var tranlateX = 'translateX(-' + pageWidth * (++curIndex) + '%)';
    pagesDom.css(transform, tranlateX);
    $('.wscn-page[data-page-index="' + curIndex + '"]').addClass('curentPage');

}

$('.wscn-pages').on(touch_start, '.btn-choice', function() {
    $(this).addClass('btn-choice-select').siblings().removeClass('btn-choice-select');

    var model = models[curIndex];
    var qIndex = $(this).attr('data-q-index');

    if (qIndex == '1') {
        profit += +model.answer1.value;
    } else if (qIndex == '2') {
        profit += +model.answer2.value;
    } else {
        profit += +model.answer3.value;
    }

    if (curIndex >= pageNum - 1) {
        $('.pages-cover').addClass('hidden');
        $('.result-page').removeClass('hidden');
        preResult();
    }
    setTimeout(function() {
        moveNext()
    }, 500)
})

function preResult() {

    var profitLevel = getProfitLevel(profit);
    $('.result-img').attr('src', 'img/result/' + profitLevel.img);
    $.each(profitLevel.contents, function(index, el) {
        var $contents = $('<div class="fadeInDown delay-' + index + '">' + el + '</div>')
        $('.result-content').append($contents)
    });

    setTimeout(function() {
        $('.download-btn img').addClass('bounce');
    }, 2600)
}

$('.replay').click(function() {
    window.location.reload()
})
</script>
<script>
var _hmt = _hmt || [];
(function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?c9477ef9d8ebaa27c94f86cc3f505fa5";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>
</body>

</html>
